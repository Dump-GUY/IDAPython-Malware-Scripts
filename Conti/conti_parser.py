import json


def hashing(API_name):
    API_buffer = []

    i = len(API_name) >> 3

    count = 0
    while i != 0:
        for index in range(0, 8):
            API_buffer.append(API_name[index + count])
        count += 8
        i -= 1

    if len(API_name) & 7 != 0:
        v8 = len(API_name) & 7

        while v8 != 0:
            API_buffer.append(API_name[count])
            count += 1
            v8 -= 1

    hash_val = 0

    for i in range(0, len(API_buffer)):
        API_buffer[i] = ord(API_buffer[i].lower())

    v15 = 0xFF889912
    string_length_2 = len(API_name)
    API_buffer_count = 0
    if len(API_name) >= 4:
        count = string_length_2 >> 2
        string_length_2 = (string_length_2 - 4 *
                           (string_length_2 >> 2)) & 0xFFFFFFFF

        while True:
            temp_buffer_val = API_buffer[API_buffer_count +
                                         3] << 24 | API_buffer[API_buffer_count +
                                                               2] << 16 | API_buffer[API_buffer_count +
                                                                                     1] << 8 | API_buffer[API_buffer_count]

            temp = (0x5BD1E995 * temp_buffer_val) & 0xFFFFFFFF
            API_buffer_count += 4
            v15 = ((0x5BD1E995 * (temp ^
                                  (temp >> 0x18))) & 0xFFFFFFFF) ^ ((0x5BD1E995 * v15) & 0xFFFFFFFF)
            count -= 1
            if count == 0:
                break

    v18 = string_length_2 - 1

    v19 = v18 - 1

    if v18 == 0:
        hash_val ^= API_buffer[API_buffer_count]
    elif v19 == 0:
        hash_val ^= API_buffer[API_buffer_count + 1] << 8
        hash_val ^= API_buffer[API_buffer_count]
    elif v19 == 1:
        hash_val ^= API_buffer[API_buffer_count + 2] << 16
        hash_val ^= API_buffer[API_buffer_count + 1] << 8
        hash_val ^= API_buffer[API_buffer_count]

    v20 = (0x5BD1E995 * hash_val) & 0xFFFFFFFF
    edi = (0x5BD1E995 * len(API_name)) & 0xFFFFFFFF

    eax = v20 >> 0x18
    eax ^= v20

    ecx = (0x5BD1E995 * eax) & 0xFFFFFFFF
    eax = (0x5BD1E995 * v15) & 0xFFFFFFFF

    ecx ^= eax

    eax = edi
    eax >>= 0x18
    eax ^= edi

    edx = (0x5BD1E995 * ecx) & 0xFFFFFFFF
    eax = (0x5BD1E995 * eax) & 0xFFFFFFFF
    edx ^= eax
    eax = edx

    eax >>= 0xD
    eax ^= edx

    ecx = (0x5BD1E995 * eax) & 0xFFFFFFFF
    eax = ecx
    eax >>= 0xF
    eax ^= ecx

    return eax


def setup(json_file):
    global export_hashes
    exports_json = json.loads(open(json_file, 'rb').read())
    exports_list = exports_json['exports']
    for export in exports_list:
        api_hash = hashing(export)
        export_hashes[api_hash] = export


export_hashes = {}

setup('exports.json')

print(export_hashes[0xE6E607E4])
