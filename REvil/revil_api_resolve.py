import json

def transform_hash(original_hash):
    transformed_hash = original_hash ^ (original_hash << 16) ^ 0xA1AF95F0
    return transformed_hash & 0x1FFFFF


API_hash = json.loads(open('C:\\Users\\cdong49\\Desktop\\sodinokibi\\exports.json','r').read())

STARTING_EA = 0x411298
API_COUNT = 190

curr_ea = STARTING_EA
for i in range(0, 190):
    target_hash = str(transform_hash(int.from_bytes(idc.get_bytes(curr_ea, 4), 'little')))
    if target_hash in API_hash:
        idc.set_name(curr_ea, 'mw_' + API_hash[target_hash],idaapi.SN_FORCE)
    curr_ea += 4






