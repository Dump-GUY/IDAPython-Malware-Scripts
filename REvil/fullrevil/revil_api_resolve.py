import json

def transform_hash(original_hash):
    transformed_hash = original_hash ^ (original_hash << 16) ^ 0x99CD8ECD
    return transformed_hash & 0x1FFFFF


API_hash = json.loads(open('C:\\Users\\cdong49\\Desktop\\new_revil\\9b11711efed24b3c6723521a7d7eb4a52e4914db7420e278aa36e727459d59dd\\exports.json','r').read())

STARTING_EA = 0x2CA2590
API_COUNT = 204

curr_ea = STARTING_EA
for i in range(0, API_COUNT):
    target_hash = str(transform_hash(int.from_bytes(idc.get_bytes(curr_ea, 4), 'little')))
    if target_hash in API_hash:
        idc.set_name(curr_ea, 'mw_' + API_hash[target_hash],idaapi.SN_FORCE)
    curr_ea += 4






